{
  "hash": "2d01f4556987c6f9bea0d33176cd83ac",
  "result": {
    "markdown": "---\ntitle: \"e-StatğŸ¤R\"\nsubtitle: \"Tokyo.R #108\"\nauthor: UchidaMizuki\ndate: \"2023-09-02\"\nfooter: <https://github.com/UchidaMizuki/jpstat>\nformat: \n  revealjs\n---\n\n\n## [e-Stat](https://www.e-stat.go.jp)ã¨ã¯â“\n\n-   æ—¥æœ¬ã®æ”¿åºœçµ±è¨ˆãƒãƒ¼ã‚¿ãƒ«ã‚µã‚¤ãƒˆ\n-   å¤šãã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ãŒæ¤œç´¢ãƒ»é–²è¦§ãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹\n\n![ç”»åƒå‡ºå…¸ï¼še-Stat](https://www.e-stat.go.jp/sites/default/files/inline-images/e-stat_001_1.png){fig-align=\"center\"}\n\n## e-Statã®ä½¿ã„æ–¹ğŸ“Œ\n\n### 1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ¤œç´¢ğŸ”\n\n![ç”»åƒå‡ºå…¸ï¼še-Stat](https://www.e-stat.go.jp/sites/default/files/inline-images/e-stat_003.png){fig-align=\"center\"}\n\n## e-Statã®ä½¿ã„æ–¹ğŸ“Œ\n\n### 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’é¸æŠğŸ‘†\n\n![ç”»åƒå‡ºå…¸ï¼še-Stat](https://www.e-stat.go.jp/sites/default/files/inline-images/e-stat_039.png){fig-align=\"center\"}\n\n## e-Statã®ä½¿ã„æ–¹ğŸ“Œ\n\n### 3. ãƒ‡ãƒ¼ã‚¿é …ç›®ã‚’é¸æŠâœ…\n\n![ç”»åƒå‡ºå…¸ï¼še-Stat](https://www.e-stat.go.jp/sites/default/files/inline-images/e-stat_040.png){fig-align=\"center\"}\n\n## e-Statã®ä½¿ã„æ–¹ğŸ“Œ\n\n### 4. ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ğŸ’¾\n\n![ç”»åƒå‡ºå…¸ï¼še-Stat](https://www.e-stat.go.jp/sites/default/files/inline-images/dbview01_1.png){fig-align=\"center\"}\n\n## e-StatğŸ¤R {auto-animate=\"true\"}\n\n### [e-Stat API](https://www.e-stat.go.jp/api/)\n\nRã‹ã‚‰ã‚‚e-Statã‚’åˆ©ç”¨å¯èƒ½â©[estatapi](https://yutannihilation.github.io/estatapi/)ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ğŸ“¦\n\n1.  ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ¤œç´¢ğŸ”\n2.  ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’é¸æŠğŸ‘†\n3.  ãƒ‡ãƒ¼ã‚¿é …ç›®ã‚’é¸æŠâœ…\n4.  ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ğŸ’¾\n\n## e-StatğŸ¤R {auto-animate=\"true\"}\n\n### [e-Stat API](https://www.e-stat.go.jp/api/)\n\nStep 3ä»¥é™ã®ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºãƒ»æ•´å½¢ãŒã‚„ã‚„é›£ã—ã„ğŸ˜–\n\n3.  ãƒ‡ãƒ¼ã‚¿é …ç›®ã‚’é¸æŠâœ…\n4.  ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ğŸ’¾\n\n::: {.fragment .fade-in}\nâ¬\n\n### [jpstat](https://uchidamizuki.github.io/jpstat/)ğŸ“¦\n\n-   dplyrğŸ“¦ã¨ãƒ‘ã‚¤ãƒ—ï¼ˆ`|>, %>%`ï¼‰ã§ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºå¯èƒ½ğŸ‘\n-   çµ±è¨ˆãƒ‡ãƒ¼ã‚¿åé›†ã®åŠ¹ç‡æ€§ãƒ»å†ç¾æ€§å‘ä¸ŠğŸ‘\n:::\n\n## jpstatğŸ“¦ã®ä½¿ã„æ–¹ğŸ“Œ\n\n### 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³IDã‚’è¨­å®š[^1]\n\n[^1]: äº‹å‰ã«[åˆ©ç”¨è¦ç´„](https://www.e-stat.go.jp/api/api-info/api-guide)ã‚’ã”ç¢ºèªãã ã•ã„\n\n-   e-Stat APIã®åˆ©ç”¨ã«ã¯[ãƒ¦ãƒ¼ã‚¶ç™»éŒ²](https://www.e-stat.go.jp/mypage/user/preregister)ãŒå¿…è¦\n-   [åˆ©ç”¨ã‚¬ã‚¤ãƒ‰](https://www.e-stat.go.jp/api/api-info/api-guide)ã«å¾“ã£ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³IDã‚’å–å¾—\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"8-9\"}\n# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆå¿…è¦ãªã‚‰ï¼‰ãƒ»èª­ã¿è¾¼ã¿\nif (!require(\"tidyverse\")) install.packages(\"tidyverse\")\nif (!require(\"jpstat\")) install.packages(\"jpstat\")\n\nlibrary(tidyverse)\nlibrary(jpstat)\n\n# ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³IDã‚’è¿½åŠ \nSys.setenv(ESTAT_API_KEY = \"ã‚ãªãŸã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ID\")\n```\n:::\n\n\n## jpstatğŸ“¦ã®ä½¿ã„æ–¹ğŸ“Œ {auto-animate=\"true\"}\n\n### 2. ãƒ‡ãƒ¼ã‚¿é …ç›®ã‚’å–å¾—[^2]\n\n[^2]: ãƒ¡ã‚¿æƒ…å ±ã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ï¼\n\n[å®¶è¨ˆèª¿æŸ»](https://www.e-stat.go.jp/dbview?sid=0003343671)ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å¯¾è±¡[^3]\n\n[^3]: [estatapi](https://yutannihilation.github.io/estatapi/)ğŸ“¦ã®READMEã‚’å‚è€ƒã«ï¼ãŸã ã—ï¼Œã“ã“ã§ã¯2023å¹´ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ï¼\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestat(statsDataId = \"0003343671\") # statsDataId: URLç­‰ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹çµ±è¨ˆè¡¨ID\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# â˜ tab:   è¡¨ç« é …ç›®               [1] <code, name, level>\n# â˜ cat01: å“ç›®åˆ†é¡ï¼ˆ2020å¹´æ”¹å®šï¼‰ [690] <code, name, level, unit, parentCode>\n# â˜ cat02: ä¸–å¸¯åŒºåˆ†               [4] <code, name, level>\n# â˜ area:  åœ°åŸŸåŒºåˆ†               [53] <code, name, level>\n# â˜ time:  æ™‚é–“è»¸ï¼ˆæœˆæ¬¡ï¼‰         [462] <code, name, level>\n# \n# Please `activate()`.\n```\n:::\n:::\n\n\n## jpstatğŸ“¦ã®ä½¿ã„æ–¹ğŸ“Œ {auto-animate=\"true\"}\n\n### 3. ãƒ‡ãƒ¼ã‚¿é …ç›®ã‚’æŠ½å‡º\n\n`activate(), filter()`ã§ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆé–¢é€£å“ç›®ã‚’æŠ½å‡º\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"2-3\"}\nestat(statsDataId = \"0003343671\") |> \n  activate(cat01) |> \n  filter(str_detect(name, \"ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# â˜ tab:   è¡¨ç« é …ç›®               [1] <code, name, level>\n# â˜’ cat01: å“ç›®åˆ†é¡ï¼ˆ2020å¹´æ”¹å®šï¼‰ [2] <code, name, level, unit, parentCode>\n# â˜ cat02: ä¸–å¸¯åŒºåˆ†               [4] <code, name, level>\n# â˜ area:  åœ°åŸŸåŒºåˆ†               [53] <code, name, level>\n# â˜ time:  æ™‚é–“è»¸ï¼ˆæœˆæ¬¡ï¼‰         [462] <code, name, level>\n# \n# A tibble: 2 Ã— 5\n  code      name                 level unit  parentCode\n  <chr>     <chr>                <chr> <chr> <chr>     \n1 010800130 352 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ     5     å††    010800000 \n2 010800140 353 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆè“å­ 5     å††    010800000 \n```\n:::\n:::\n\n\n## jpstatğŸ“¦ã®ä½¿ã„æ–¹ğŸ“Œ {auto-animate=\"true\"}\n\n### 3. ãƒ‡ãƒ¼ã‚¿é …ç›®ã‚’æŠ½å‡º\n\nè¤‡æ•°ã®æŠ½å‡ºå‡¦ç†ã‚’ãƒ‘ã‚¤ãƒ—ï¼ˆ`|>, %>%`ï¼‰ã§ã¤ãªã’ã‚‰ã‚Œã‚‹\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"5-9\"}\nestat(statsDataId = \"0003343671\") |> \n  activate(cat01) |> \n  filter(str_detect(name, \"ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ\")) |> \n  \n  activate(area) |> \n  filter(name == \"å…¨å›½\") |> \n  \n  activate(time) |> \n  filter(str_detect(name, \"2023å¹´[1-3]æœˆ\"))\n```\n:::\n\n\n## jpstatğŸ“¦ã®ä½¿ã„æ–¹ğŸ“Œ {auto-animate=\"true\"}\n\n### 4. ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\n\n`collect()`ã§ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"1,11\"}\nchocolate <- estat(statsDataId = \"0003343671\") |> \n  activate(cat01) |> \n  filter(str_detect(name, \"ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ\")) |> \n  \n  activate(area) |> \n  filter(name == \"å…¨å›½\") |> \n  \n  activate(time) |> \n  filter(str_detect(name, \"2023å¹´[1-3]æœˆ\")) |> \n  \n  collect(n = \"é‡‘é¡\") # `n`ã§åé›†ãƒ‡ãƒ¼ã‚¿ã®åˆ—åã‚’æŒ‡å®š\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThe total number of data is 12.\n```\n:::\n:::\n\n\n## jpstatğŸ“¦ã®ä½¿ã„æ–¹ğŸ“Œ {auto-animate=\"true\"}\n\n### 4. ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\n\nã“ã®ã¾ã¾ã§ã¯åˆ—åãŒã‚ã‹ã‚Šã¥ã‚‰ãä¸è¦ãªåˆ—ãŒå¤šã„ğŸ˜–\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(chocolate)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 Ã— 18\n  tab_code tab_name tab_level cat01_code cat01_name       cat01_level cat01_unit\n  <chr>    <chr>    <chr>     <chr>      <chr>            <chr>       <chr>     \n1 01       é‡‘é¡     \"\"        010800130  352 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ 5           å††        \n2 01       é‡‘é¡     \"\"        010800130  352 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ 5           å††        \n3 01       é‡‘é¡     \"\"        010800130  352 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ 5           å††        \n4 01       é‡‘é¡     \"\"        010800130  352 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ 5           å††        \n5 01       é‡‘é¡     \"\"        010800130  352 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ 5           å††        \n6 01       é‡‘é¡     \"\"        010800130  352 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ 5           å††        \n# â„¹ 11 more variables: cat01_parentCode <chr>, cat02_code <chr>,\n#   cat02_name <chr>, cat02_level <chr>, area_code <chr>, area_name <chr>,\n#   area_level <chr>, time_code <chr>, time_name <chr>, time_level <chr>,\n#   é‡‘é¡ <chr>\n```\n:::\n:::\n\n\n## jpstatğŸ“¦ã®ä½¿ã„æ–¹ğŸ“Œ {auto-animate=\"true\"}\n\n### 5. ãƒ‡ãƒ¼ã‚¿ã‚’æ•´å½¢\n\n`rekey(), select()`ã§åé›†ãƒ‡ãƒ¼ã‚¿ã®åˆ—åã‚’æŒ‡å®šã§ãã‚‹\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"2,4,7,9,12\"}\nchocolate <- estat(statsDataId = \"0003343671\") |> \n  activate(tab) |> select() |> # ä½•ã‚‚`select()`ã—ãªã„å ´åˆã¯åˆ—åãŒæ¶ˆãˆã‚‹\n    \n  activate(cat01) |> rekey(\"å“ç›®åˆ†é¡\") |> select(name) |> \n  filter(str_detect(name, \"ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ\")) |> \n  \n  activate(cat02) |> rekey(\"ä¸–å¸¯åŒºåˆ†\") |> select(name) |>\n  \n  activate(area) |> rekey(\"åœ°åŸŸåŒºåˆ†\") |> select(name) |>\n  filter(name == \"å…¨å›½\") |> \n  \n  activate(time) |> rekey(\"æœˆæ¬¡\") |> select(name) |>\n  filter(str_detect(name, \"2023å¹´[1-3]æœˆ\")) |> \n  \n  collect(n = \"é‡‘é¡\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThe total number of data is 12.\n```\n:::\n:::\n\n\n## jpstatğŸ“¦ã®ä½¿ã„æ–¹ğŸ“Œ {auto-animate=\"true\"}\n\n### 5. ãƒ‡ãƒ¼ã‚¿ã‚’æ•´å½¢\n\nåˆ—åãŒã‚ã‹ã‚Šã‚„ã™ããªã‚Šä¸è¦ãªåˆ—ãŒæ¶ˆãˆãŸğŸ‘\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(chocolate)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 Ã— 5\n  å“ç›®åˆ†é¡_name    ä¸–å¸¯åŒºåˆ†_name                   åœ°åŸŸåŒºåˆ†_name æœˆæ¬¡_name é‡‘é¡ \n  <chr>            <chr>                           <chr>         <chr>     <chr>\n1 352 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ äºŒäººä»¥ä¸Šã®ä¸–å¸¯ï¼ˆ2000å¹´ï½ï¼‰      å…¨å›½          2023å¹´1æœˆ 869  \n2 352 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ äºŒäººä»¥ä¸Šã®ä¸–å¸¯ï¼ˆ2000å¹´ï½ï¼‰      å…¨å›½          2023å¹´2æœˆ 1307 \n3 352 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ äºŒäººä»¥ä¸Šã®ä¸–å¸¯ï¼ˆ2000å¹´ï½ï¼‰      å…¨å›½          2023å¹´3æœˆ 656  \n4 352 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ äºŒäººä»¥ä¸Šã®ä¸–å¸¯ã®ã†ã¡å‹¤åŠ´è€…ä¸–å¸¯â€¦ å…¨å›½          2023å¹´1æœˆ 998  \n5 352 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ äºŒäººä»¥ä¸Šã®ä¸–å¸¯ã®ã†ã¡å‹¤åŠ´è€…ä¸–å¸¯â€¦ å…¨å›½          2023å¹´2æœˆ 1491 \n6 352 ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ äºŒäººä»¥ä¸Šã®ä¸–å¸¯ã®ã†ã¡å‹¤åŠ´è€…ä¸–å¸¯â€¦ å…¨å›½          2023å¹´3æœˆ 749  \n```\n:::\n:::\n\n\n## ã¾ã¨ã‚ğŸ“‹\n\n-   jpstatğŸ“¦ã§e-Statãƒ‡ãƒ¼ã‚¿ã®åé›†ã‚’ç°¡å˜ã«\n-   ä»–ã®çµ±è¨ˆAPIã«ã‚‚å¯¾å¿œã™ã‚‹ã‹ã‚‚\n    -   å®Ÿé¨“çš„ã«RESAS APIãªã©ã«ã‚‚å¯¾å¿œ\n-   Issueã‚„Pull Requestã¯[UchidaMizuki/jpstat](https://github.com/UchidaMizuki/jpstat)ã¾ã§\n\n## EnjoyğŸ«\n\nä½™è«‡ï¼š2æœˆã¯ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆæ¶ˆè²»ãŒå¢—ãˆã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸâ—\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nchocolate |> \n  mutate(ä¸–å¸¯åŒºåˆ†_name = ä¸–å¸¯åŒºåˆ†_name |> \n           str_remove(\"ï¼ˆ2000å¹´ï½ï¼‰$\") |> \n           as_factor(),\n         é‡‘é¡ = parse_number(é‡‘é¡)) |> \n  ggplot(aes(æœˆæ¬¡_name, é‡‘é¡,\n             fill = ä¸–å¸¯åŒºåˆ†_name)) +\n  geom_col(position = \"dodge\") +\n  scale_x_discrete(NULL) +\n  scale_y_continuous(\"1ä¸–å¸¯ã‚ãŸã‚Šé‡‘é¡ï¼»å††ï¼½\",\n                     labels = scales::label_comma()) +\n  scale_fill_brewer(\"ä¸–å¸¯åŒºåˆ†\",\n                    palette = \"Paired\") +\n  facet_wrap(~ å“ç›®åˆ†é¡_name)\n```\n\n::: {.cell-output-display}\n![](slide-estat-with-r_files/figure-revealjs/unnamed-chunk-10-1.png){width=960}\n:::\n:::\n",
    "supporting": [
      "slide-estat-with-r_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    // dispatch for htmlwidgets\r\n    function fireSlideEnter() {\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n    }\r\n\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n      fireSlideEnter();\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}